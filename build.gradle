plugins {
    id 'java'
    id 'org.jetbrains.kotlin.jvm' version '1.2.50'
}

group 'afis'
version '1.0-SNAPSHOT'

sourceCompatibility = 1.8

repositories {
    mavenCentral()
}

dependencies {
    compile "org.jetbrains.kotlin:kotlin-stdlib-jdk8"
    testCompile("org.junit.jupiter:junit-jupiter-api:5.0.0")
    testRuntime("org.junit.jupiter:junit-jupiter-engine:5.0.0")
}

compileKotlin {
    kotlinOptions.jvmTarget = "1.8"
}
compileTestKotlin {
    kotlinOptions.jvmTarget = "1.8"
}

jar {
    manifest {
        attributes "Main-Class": "jp.co.afis.Main"
    }
    from configurations.compile.collect { it.isDirectory() ? it : zipTree(it) }
}

task zipApp(type: Zip, dependsOn: jar) {
    archiveName = "afis.zip"
    from "build/libs/afis-1.0-SNAPSHOT.jar"
    into("config") {
        from "config/koma.properties"
        from "config/play.properties"
    }
    into("log") {
        from "log/dummy.txt"
    }
    from "README.txt"
}

artifacts {
    archives zipApp
}
